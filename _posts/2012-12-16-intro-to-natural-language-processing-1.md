---
layout: post
title: Intro to Natural Language Processing (1)
date: 2012-12-16 17:14:00
categories: [blog, blogger]
tags: [Harmony Institute, information extraction, Natural Language Processing, NLTK, zombies]
comments: true
---

First, the big news: I got a job! I'm now a data scientist at a non-profit organization here in Manhattan called [Harmony Institute](http://harmony-institute.org/), where we study the science of influence through entertainment. Basically, simple metrics like box office sales and television viewers don't adequately quantify a film or show's social impact; we use theory-driven methodology to more fully assess this impact in individuals and across networks. In the case of, say, a social justice documentary that was made specifically to have such an impact, we are able to quantify the film's level of success. More on this over time, I'm sure.

<iframe width="560" height="315" src="//www.youtube.com/embed/S67X2Q5rOW4" frameborder="0" allowfullscreen></iframe>

Second, more big news: "Decay," the feature-length, physics-themed zombie movie I co-produced, filmed, and edited while also earning my physics PhD at CERN has been released online! You can [watch or download it](http://www.decayfilm.com/pages/download.html) for free! We've had over 200,000 views and downloads in the first week alone, and a fair amount of international press. I've been tracking our "buzz" for the past couple months and will do some fancy analytics after we're off the post-release peak, so stay tuned. And check out the movie, people seem to have really enjoyed it. :)

<iframe width="560" height="315" src="//www.youtube.com/embed/n-NwLUPZWZc" frameborder="0" allowfullscreen></iframe>

Now, back to data science! I wanted to properly introduce Natural Language Processing (NLP for short) after briefly mentioning it in [my previous post]({% post_url 2012-11-26-web-scraping-and-html-parsing-2 %}) on web scraping. As you probably know from personal experience, much of the information available online comes in the form of "natural language" like English or Spanish (as opposed to "structured language" like Python or mathematics). Broadly speaking, NLP is computer manipulation of natural language: from word counts to [AutoCorrect](http://en.wikipedia.org/wiki/Autocorrection), [machine translation](http://translate.google.com/) to sentiment analysis, part-of-speech tagging to [speech recognition](http://www.smartplanet.com/blog/smart-takes/say-command-how-speech-recognition-will-change-the-world/19895). NLP is a huge and increasingly vital field, allowing for more intuitive human-computer interaction and, of particular importance to data scientists, more effective extraction of structured information from unstructured text.

Here I'll focus on that last bit, the very useful task of [information extraction](http://en.wikipedia.org/wiki/Information_extraction). Essentially, we want to identify information expressed in a natural language document and convert it into a structured, machine-friendly representation for further analysis. In practice, however, it's much easier to focus on asking specific questions, i.e. looking for specific "entity relations" in the text. Let's say we want to know who created the X-men comics given the first paragraph of [their Wikipedia page](http://en.wikipedia.org/wiki/X-Men):

> The X-Men are a superhero team in the Marvel Comics Universe. They were created by writer Stan Lee and artist Jack Kirby, and first appeared in The X-Men #1 (September 1963). The basic concept of the X-Men is that under a cloud of increasing anti-mutant sentiment, Professor Xavier created a haven at his Westchester mansion to train young mutants to use their powers for the benefit of humanity, and to prove mutants can be heroes. Xavier recruited Cyclops, Iceman, Angel, Beast, and Marvel Girl, calling them "X-Men" because they possess special powers due to their possession of the "X-gene," a gene which normal humans lack and which gives mutants their abilities.

A person can read this and readily answer the question --- Stan Lee and Jack Kirby --— but the complexity of natural language makes it difficult for a machine to do the same. It helps to split the task into an ordered pipeline of sub-tasks, starting from the raw text of a document and ending with a list of relations:

1. __Sentence Segmentation:__ Before manipulating text at the level of individual words, it is often necessary to split or "segment" the text into sentences. This isn't trivial, since periods are used in acronyms (U.S.A., Mr.) as well sentence endings --— sometimes simultaneously —-- and other sentence-ending punctuation (?!) may be used in different, non-standard ways. (Note that this is for English; other languages do things differently!) Using the raw text as input, this step outputs a list of its constituent sentences, e.g. <span style="font-family:courier">['The X-men are a superhero team in the Marvel Comics Universe.', 'They were created by writer Stan Lee and artist Jack Kirby, and first appeared in The X-Men #1 (September 1963).', ...]</span>
2. __Word Tokenization:__ Before trying to understand the meanings of words, we first have to identify the words themselves. In English, words are generally delimited by white space, though that fails in the common case of contractions ("it's" = "it" and "is"; "won't" = "will" and "not"). In other languages such as Chinese or Thai, where words are _not_ delimited, word tokenization is much harder. In this step, our input is a list of sentences and our output is a _nested_ list of sentences in which each sentence is represented by a list of its constituent words, e.g. <span style="font-family:courier">[['The', 'X-men', 'are', 'a', 'superhero', 'team', 'in', 'the', 'Marvel', 'Comics', 'Universe,' '.'], ...]</span>
3. __Part-of-speech Tagging:__ The process of classifying words by their parts-of-speech and labeling them accordingly is known as part-of-speech tagging, or POST. This is another necessary precursor to understanding the relationships between words in a sentence, given that the same words may represent different parts of speech in different contexts. For example: "Gas prices are _up_ [adverb]." vs "He climbed _up_ [preposition] the ladder." vs "They've had some _ups_ [noun] and downs." From a nested list of sentences of words, this step outputs a nested list in which each word is stored as a pair, with one value for the word itself and another for its part of speech, e.g. <span style="font-family:courier">[[('The', 'DT'), ('X-Men', 'JJ'), ('are', 'VBP'), ('a', 'DT'), ('superhero', 'NN'), ('team', 'NN'), ('in', 'IN'), ('the', 'DT'), ('Marvel', 'NNP'), ('Comics', 'NNP'), 'Universe', 'NNP'), ('.', '.')], ...]</span>
4. __Entity Recognition:__ Higher-level conceptual entities are recognized as such through a process called _chunking_, a common precursor to relation recognition (our end goal) in which linked sets of words are grouped or "chunked" together. You can chunk noun phrases, or verb phrases, or prepositional phrases based on words' ordering and parts-of-speech in a sentence; often, you want to look for _named entities_ ("NE") that correspond to people, places, organizations, etc. The output of this step is a list of hierarchical trees, e.g. <span style="font-family:courier">[Tree('S', [('The', 'DT'), ('X-Men', 'JJ'), ('are', 'VBP'), ('a', 'DT'), ('superhero', 'NN'), ('team', 'NN'), ('in', 'IN'), ('the', 'DT'), Tree('ORGANIZATION', [('Marvel', 'NNP'), ('Comics', 'NNP'), ('Universe', 'NNP')]), ('.', '.')])], ...]</span> __Note:__ The chunker correctly recognized "Marvel Comics Universe" but missed "The X-Men," partly because the POST incorrectly classified "X-Men" as an adjective ("JJ"). NLP is a statistical process, and errors happen!
5. __Relation Recognition:__ Finally, we can try to identify the relations that exist between entities. This may be possible through a regular expression parser that looks for a particular order of consecutive parts of speech, or something fancier using the hierarchical relationships between named entities. In the case of the former, searching for one or more verbs followed by a preposition followed by one or more nouns (<span style="font-family:courier">"\<VB.\*>+\<IN>\<NN.\*>+"</span>) would find information of the form "created by writer Stan Lee." As it turns out, that phrase is the only one in our example paragraph that fits the pattern, and it is indeed a partial answer to our question. Note, however, that it misses the full answer: "created by writer Stan Lee and artist Jack Kirby." This can be accounted for in the parser's pattern, sure, but it's much tougher knowing ahead of time what to search for and whether you've correctly found it.

This has been a little preview of the power of natural language processing. Throughout, I've used a comprehensive Python package called the Natural Language ToolKit (NLTK), available for free download [here](http://nltk.org/); happily, [a companion textbook](http://nltk.org/book/) is also available for free, and together they provide an accessible introduction to NLP that will take you pretty far. If you want to learn more, you might also want to sign up for [an upcoming Coursera class](https://www.coursera.org/course/nlp) on the topic, though its date is still TBD.

I've been using NLP and NLTK quite a bit in my new job —-- not to mention web scraping, among other things —-- so I'm sure this topic will keep coming up. Stay tuned.
